%!TEX root = thesis.tex

\chapter{Appendix}
\label{chap:app}

\section{Working with the updated NWB motorways}
\label{sec:nwb_updated}

\subsection{Updated NWB geometry}
\label{sub:nwb_updated_geometry}

In an effort to resolve some of the problems regarding \ac{nwb}'s georeferencing issues, \ac{ndw} has commissioned a commercial project. Like their commercial project to convert \ac{nwb} to 3D, this project relied entirely on \ac{dtb}. Together with the \ac{bgt}-based refinement of municipal roads, this means that \ac{g-roads} and \ac{r-roads} are becoming more and more accurate in terms of their 2D positions.

My project was affected noticeably by the coarse georeferencing of this dataset. While it is theoretically possible to derive elevations for the road network that comply with the 20 cm elevation accuracy requirement, the elevations will not necessarily reflect elevation at the desired 2D location, in locations where \ac{NWB}'s georeferencing is particularly inaccurate. Furthermore, the fact that it is impossible to predict where the centreline lies on a given road surface (and in places, \textit{whether} it even lies on it) caused practical issues with my procedures.

Figure \ref{fig:nwb_updated_geometry} shows the differences between some original \ac{nwb} geometries and the updated ones in the \textit{Knooppunt Deil} area. The displacements are typically on the 0-1 m scale, but I observed up to 3 metre in certain locations. In the region shown by the figure, the displacement is 1-2.5 m in the locations labelled as "large shifts in NWB's location". As noted in various places in this report, problems are most common in sharp bends. Accordingly, the updated geometry shows the largest displacement relative to the original in sharp bends. The second most common location is where no \ac{nwb} vertices are present for hundreds of metres due to the local straightness of certain motorways. This type of simplification results in several metres of displacement that may be present for most of the simplified length of the road (hundreds of metres).

As the centrelines were "centred" using \ac{dtb} lines, the refinements were only carried out for motorways, and only where sufficient \ac{dtb} data is present, i.e. at least the two road edge lines. In the testing dataset shown by Figure \ref{fig:nwb_updated}, this means about 75\% of the total length of the roads.

\subsection{Impact on edge approximation}
\label{sub:nwb_updated_edgeapproximation}

The procedures from my processing pipeline that suffer the most from this situation are the edge approximation (and optimisation) and TIN construction workflows. In this section, I will discuss how edge approximation is affected.

The main reason why edge approximation is sensitive to \ac{nwb}'s 2D location is that it assumes that the centrelines are always located on the road surfaces, and because the fixed-length cross-sections may extend into confusing areas if \ac{nwb} is close to either of the edges of a given road. For instance, if the centrelines veers to the right and there is a flat region with a similar elevation beyond the edge of the road, the cross-section's elevations may not be classed as outliers there, in turn attracting the generated edges off the road. The workarounds I implemented to bypass the issue do not have a 100\% effectiveness, meaning that improvements to the 2D georeferencing accuracy of \ac{nwb} are expected to result in noticeable improvements in the effectiveness of this pipeline step.

Figure \ref{fig:nwb_updated_edgeapproximation} compares the generated edges prior to the refinement of the centrelines, and after. The main type of improvement noticeable in the new edges and cross-sections is that in bends, less cross-sections are skipped, and the new edges better define the extents of the road surface. The edges no longer contain short-wavelength extensions into off-road areas and are thus at a relatively constant distance from each other, even where the bends are quite sharp. This improvement is also noticeable where the same issue exists for the opposite reason (i.e. where \ac{nwb} is vastly oversimplified due to it being more or less straight for a long distance).

The second, less intuitive improvement is due to the fact that already during the Lidar segmentation step, points relevant to the given road surface are selected more effectively. Less off-road points being included in the queries result in the plane fits being more accurate. This bump in effectiveness means that the algorithm now performs well in areas where it had failed before. In the upper visualisation in Figure \ref{fig:nwb_updated_edgeapproximation}, one of the NBRS has been split in two due to the Lidar segmentation algorithm's inability to work properly around the entraces of the small tunnel that exists there. This also resulted in the DTB points inside the tunnel not being found, which is why the NBRS was split into two parts there.

With the new \ac{nwb} geometry, this is no longer an issue. Since the centreline is indeed in the centre of the relevant road, the Lidar segmentation algorithm's plane fits are mostly defined by road surface points around the tunnel entrances, improving its performance drastically. The DTB elevation measurements are found and used to navigate through the tunnel. Ultimately, the NBRS needs not be split into two parts and several additional (and correct) cross-sections appear around the tunnel entrances, increasing the area properly covered by the generated road edges.

The improved edges also appear to positively affect the performance of active contour optimisation, although not to an extent where re-introducing it into the recommended 